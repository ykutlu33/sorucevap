<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sana Özel Bir Sınav!</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Varela+Round&display=swap');
        body { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); font-family: 'Varela Round', sans-serif; display: flex; align-items: center; justify-content: center; height: 100vh; margin: 0; text-align: center; color: #333;}
        .container { background-color: rgba(255, 255, 255, 0.9); padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); max-width: 90%; width: 450px; }
        h1 { font-size: 1.8rem; margin-bottom: 20px; }
        .gif { width: 150px; height: 150px; object-fit: cover; border-radius: 50%; margin-bottom: 25px; border: 4px solid #fff; }
        input[type="date"] { width: 80%; padding: 15px; border-radius: 10px; border: 2px solid #ddd; font-size: 1.2rem; text-align: center; margin-bottom: 20px;}
        .button, .option-btn { background-color: #6a11cb; color: white; border: none; padding: 15px; width: 100%; font-size: 1.1rem; border-radius: 50px; cursor: pointer; transition: all 0.3s ease; font-weight: bold; margin-top: 10px; }
        .button:hover, .option-btn:hover { background-color: #2575fc; }
        #sonuc-container h1 { color: #4caf50; }
        #sonuc-container.yanlis h1 { color: #f44336; }
    </style>
</head>
<body>
    <div id="ana-container">
        <!-- Quiz bölümleri buraya yüklenecek -->
    </div>

    <!-- Firebase Kütüphaneleri -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script>
        // Senin özel Firebase anahtarların buraya eklendi.
        const firebaseConfig = {
            apiKey: "AIzaSyAP3bZR_QQqJ8LqToEU1mdTtd5rfuoMaVY",
            authDomain: "sevgili-quizi.firebaseapp.com",
            databaseURL: "https://sevgili-quizi-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "sevgili-quizi",
            storageBucket: "sevgili-quizi.firebasestorage.app",
            messagingSenderId: "753855520594",
            appId: "1:753855520594:web:0eeb1d98eb3cdc1e21e48b"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        let quizVerisi;
        let kullaniciCevaplari = {};
        const anaContainer = document.getElementById('ana-container');

        window.onload = function() {
            const quizId = window.location.hash.substring(1);
            if (!quizId) {
                anaContainer.innerHTML = '<h1>Hatalı Link!</h1>';
                return;
            }
            
            const quizRef = database.ref('quizzes/' + quizId);
            quizRef.once('value').then((snapshot) => {
                if (!snapshot.exists()) {
                    anaContainer.innerHTML = '<h1>Böyle bir quiz bulunamadı!</h1>';
                    return;
                }
                quizVerisi = snapshot.val();
                soru1Goster();
            });
        };
        
        function soru1Goster() {
            anaContainer.innerHTML = `
                <div class="container" id="quiz-bolumu-1">
                    <h1>İlk Soru: İlk Buluşma Tarihimiz?</h1>
                    <img src="ana.gif" alt="Ana GIF" class="gif">
                    <input type="date" id="cevap-input-1">
                    <button class="button" onclick="soru1Kontrol()">Sıradaki Soru</button>
                </div>`;
        }
        
        function soru1Kontrol() {
            const cevap1 = document.getElementById('cevap-input-1').value;
            if (!cevap1) { alert("Lütfen bir tarih seç!"); return; }
            kullaniciCevaplari.soru1 = cevap1;
            soru2Goster();
        }

        function soru2Goster() {
            let secenekButonlari = '';
            quizVerisi.secenekler.forEach((secenek, index) => {
                secenekButonlari += `<button class="option-btn" onclick="soru2Kontrol(${index})">${secenek}</button>`;
            });

            anaContainer.innerHTML = `
                <div class="container" id="quiz-bolumu-2">
                    <h1>${quizVerisi.soru2_metin}</h1>
                    <img src="ana.gif" alt="Ana GIF" class="gif">
                    <div id="secenekler-kutusu">${secenekButonlari}</div>
                </div>`;
        }

        function soru2Kontrol(secilenIndex) {
            kullaniciCevaplari.soru2 = secilenIndex;
            
            database.ref('quizzes/' + window.location.hash.substring(1) + '/cevaplar').set(kullaniciCevaplari);

            sonuclariGoster();
        }

        function sonuclariGoster() {
            const dogruCevap1 = quizVerisi.soru1_cevap;
            const dogruCevap2_index = parseInt(quizVerisi.soru2_dogru_index);
            let sonucHTML = '';

            if (kullaniciCevaplari.soru1 === dogruCevap1 && kullaniciCevaplari.soru2 === dogruCevap2_index) {
                sonucHTML = `
                    <div class="container" id="sonuc-container">
                        <h1>TEBRİKLER AŞKIM!</h1>
                        <p>Tüm anılarımızı hatırlamana o kadar sevindim ki... Sen harikasın!</p>
                        <img src="dogru.gif" alt="Doğru Cevap GIF" class="gif">
                    </div>`;
            } else {
                sonucHTML = `
                    <div class="container" id="sonuc-container" class="yanlis">
                        <h1>BİRAZCIK UNUTMUŞUZ SANKİ...</h1>
                        <p>Olsun, aşkımız her şeyden önemli. Gel birlikte yeni anılar biriktirelim!</p>
                        <img src="yanlis.gif" alt="Yanlış Cevap GIF" class="gif">
                    </div>`;
            }
            anaContainer.innerHTML = sonucHTML;
        }
    </script>
</body>
</html>
